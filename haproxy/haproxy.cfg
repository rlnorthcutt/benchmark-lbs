global
    maxconn 4096

defaults
    mode http
    log     global
    option  httplog
    option  dontlognull
    option  http-keep-alive
    option  redispatch
    option  forwardfor
    retries 3
    timeout connect        5s
    timeout client         50s
    timeout server         50s
    timeout http-request   10s
    timeout http-keep-alive 10s
    maxconn 4096

frontend https_front
    bind *:443 ssl crt /certs/server.pem
    default_backend backend_servers

backend backend_servers
    balance leastconn
    option httpchk GET /api/health
    http-check send hdr Host backend.local
    http-check expect status 200
    # Keep-alive to servers (default)
    server backend1 backend:3000 ssl verify none check inter 5s rise 2 fall 3 maxconn 2000
